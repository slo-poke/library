<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>My Library</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1copy" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</head>
<body>
    <div class="topDiv">
        <h1>Welcome, {{ name }}!</h1>
        <a href="/logout">Log off</a>
    </div>
    <div class="nav">
        <ul>
            <li><a href="/home">Home</a></li>
            <li class="dropdown">
                <a href="/user_profile" class="dropdownBtn">Account</a>
                <div class="dropdown_content">
                    <a href="/order_history">Order History</a>
                    <a href="/user_profile">Profile</a>
                    {% if session['user'][0]['user_group'] == "admin" %}
                        <a href="/get_user">Update User</a>
                        <a href="/add_book">Add Book</a>
                        <a href="/checkout">Check Out</a>
                        <a href="/checkin">Check In</a>
                        <a href="/add_event">Add Event</a>
                        <a href="/choose_event">Update Event</a>
                    {% endif %}
                </div>
            </li>
            <li><a href="/search">Search</a></li>
        </ul>
    </div>
    <div class="wrapper">
        {% with successes = get_flashed_messages(category_filter=['success']) %}
            {% if successes %}
                {%- for msg in successes %}
                    <p class="success">{{ msg }}</p>
                {% endfor -%}
            {% endif %}
        {% endwith %}
       
        <div class="collection">
            <div class="collection_inner">
            <h3>'Check out' this week's featured books!</h3>
            <div class="full_width">
                <div id="carouselExampleInterval" class="carousel slide" data-ride="carousel" style="width: 100%;">
                        <div class="carousel-inner">
                        {% for book in featured_books %}    
                        {% if book['book_id'] == featured_books[0]['book_id'] %}
                            <div class="carousel-item active" data-interval="10000" style="width: 50%; margin-left: -5%;">
                        {% else %}   
                            <div class="carousel-item" data-interval="10000" style="margin-left: -5%; width: 50%">
                        {% endif %}
                            <img src="../static/images/{{ book['image'] }}" class="book" alt="Alice In Wonderland Book Cover">
                            <div class="carousel-caption d-none d-md-block" style="text-align: left; margin-left: 50%; vertical-align: top; width: 100%; color: #000000">
                                <h5><a href="/show_book/{{ book['id']}}">{{ book['title'] }}</a></h5>
                                <p>{{ book['description'] }}</p>
                                {% if session['user'][0]['user_group'] == "admin" %}
                                    <a href="/process_feature/{{ book['book_id'] }}/{{ book['featured'] }}"><button>Unfeature</button></a>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                        </div>
                        <a class="carousel-control-prev" href="#carouselExampleInterval" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true" style="background-image: url('../static/images/left_arrow.png')"></span>
                        <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselExampleInterval" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true" style="background-image: url('../static/images/right_arrow.png')"></span>
                        <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="collection_link">
            <h2><a href="/show_all">View Our Collection Here</a></h2>
        </div>
        <div class="upcoming_events">
                <h3>Upcoming Events at the Library</h3>
                {% for event in all_events %}
                    <div class="event">
                        <h6>{{ event['event_name'] }}</h6>
                        <p>When: {{ event['date'].strftime("%b %d, %Y") }} at {{ event['time'].strftime("%I:%M %p") }}</p>
                        <p>{{ event['description'] }}</p>
                        <p>Cost: {{ "$%.2f"|format(event['cost']) }}</p>
                    </div>
                {% endfor %}
        </div>
    </div>
</body>
</html>